"""
만세력 상수 정의
- 천간(天干), 지지(地支), 오행(五行), 지장간(支藏干) 테이블
"""

# 천간 (天干) - 10개
HEAVENLY_STEMS = ["甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸"]

# 지지 (地支) - 12개
EARTHLY_BRANCHES = ["子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"]

# 천간 → 오행 매핑
STEM_TO_ELEMENT = {
    "甲": "木", "乙": "木",
    "丙": "火", "丁": "火",
    "戊": "土", "己": "土",
    "庚": "金", "辛": "金",
    "壬": "水", "癸": "水",
}

# 지지 → 오행 매핑
BRANCH_TO_ELEMENT = {
    "子": "水", "丑": "土", "寅": "木", "卯": "木",
    "辰": "土", "巳": "火", "午": "火", "未": "土",
    "申": "金", "酉": "金", "戌": "土", "亥": "水",
}

# 양간 (陽干) - 양의 천간
YANG_STEMS = ["甲", "丙", "戊", "庚", "壬"]

# 음간 (陰干) - 음의 천간
YIN_STEMS = ["乙", "丁", "己", "辛", "癸"]

# 지장간 테이블 (支藏干)
# docs/fortune_engine.md 기준: 여기(餘氣)/중기(中氣)/정기(正氣) 순서
JIJANGGAN_TABLE = {
    "子": ["癸"],              # 자 - 정기만
    "丑": ["癸", "辛", "己"],  # 축 - 여기/중기/정기
    "寅": ["戊", "丙", "甲"],  # 인
    "卯": ["乙"],              # 묘 - 정기만
    "辰": ["乙", "癸", "戊"],  # 진
    "巳": ["戊", "庚", "丙"],  # 사
    "午": ["己", "丁"],        # 오
    "未": ["丁", "乙", "己"],  # 미
    "申": ["己", "壬", "庚"],  # 신
    "酉": ["辛"],              # 유 - 정기만
    "戌": ["辛", "丁", "戊"],  # 술
    "亥": ["戊", "甲", "壬"],  # 해
}

# 오행 (五行)
ELEMENTS = ["木", "火", "土", "金", "水"]

# 오행 상생 (相生) - 나를 생하는 오행
# 木→火→土→金→水→木
ELEMENT_GENERATES = {
    "木": "火",  # 목생화
    "火": "土",  # 화생토
    "土": "金",  # 토생금
    "金": "水",  # 금생수
    "水": "木",  # 수생목
}

# 오행 상극 (相克) - 내가 극하는 오행
# 木→土→水→火→金→木
ELEMENT_OVERCOMES = {
    "木": "土",  # 목극토
    "土": "水",  # 토극수
    "水": "火",  # 수극화
    "火": "金",  # 화극금
    "金": "木",  # 금극목
}

# 오행 영문 매핑
ELEMENT_TO_ENGLISH = {
    "木": "Wood",
    "火": "Fire",
    "土": "Earth",
    "金": "Metal",
    "水": "Water",
}

# 천간 영문 발음 (로마자)
STEM_TO_ROMAJI = {
    "甲": "gap", "乙": "eul", "丙": "byeong", "丁": "jeong", "戊": "mu",
    "己": "gi", "庚": "gyeong", "辛": "sin", "壬": "im", "癸": "gye",
}

# 지지 영문 발음 (로마자)
BRANCH_TO_ROMAJI = {
    "子": "ja", "丑": "chuk", "寅": "in", "卯": "myo",
    "辰": "jin", "巳": "sa", "午": "o", "未": "mi",
    "申": "sin", "酉": "yu", "戌": "sul", "亥": "hae",
}

# 12시진 → 지지 매핑 (시간 범위)
# 자시(子時)는 23:00-01:00로 다음날로 넘어감
HOUR_RANGES = [
    (23, 1, "子"),   # 자시: 23:00-01:00
    (1, 3, "丑"),    # 축시: 01:00-03:00
    (3, 5, "寅"),    # 인시: 03:00-05:00
    (5, 7, "卯"),    # 묘시: 05:00-07:00
    (7, 9, "辰"),    # 진시: 07:00-09:00
    (9, 11, "巳"),   # 사시: 09:00-11:00
    (11, 13, "午"),  # 오시: 11:00-13:00
    (13, 15, "未"),  # 미시: 13:00-15:00
    (15, 17, "申"),  # 신시: 15:00-17:00
    (17, 19, "酉"),  # 유시: 17:00-19:00
    (19, 21, "戌"),  # 술시: 19:00-21:00
    (21, 23, "亥"),  # 해시: 21:00-23:00
]


def get_hour_branch(hour: int) -> str:
    """
    시간(0-23)을 지지로 변환

    Args:
        hour: 0-23 범위의 시간

    Returns:
        해당 시간의 지지 (한자)
    """
    if hour == 23 or hour == 0:
        return "子"
    for start, end, branch in HOUR_RANGES:
        if start <= hour < end:
            return branch
    return "子"  # 기본값
